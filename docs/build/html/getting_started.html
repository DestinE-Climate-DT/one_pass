
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Getting started &#8212; one_pass 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The config.yml file" href="the_config_file.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading">¶</a></h1>
<section id="basic-concept">
<h2>Basic Concept<a class="headerlink" href="#basic-concept" title="Permalink to this heading">¶</a></h2>
<p>The one_pass python package is designed to act on streamed climate data, generated from the Climate Digitial Twin’s (DT) climate models, and extracted from the <a class="reference external" href="https://earth.bsc.es/gitlab/digital-twins/de_340/gsv_interface">GSV interface</a>. By the end of Phase 1, the calls to both the GSV interface (for data retrival) and one_pass (for summary statistics) will be configured by the workflow manager <a class="reference external" href="https://autosubmit.readthedocs.io/en/master/">Autosubmit</a>. For information on how to configure the workflow contact work package (WP) 8. This documentation covers how to use the one_pass package and demonstrates its usage with ‘fake’ streaming.</p>
<p>The one_pass package has been built around a few core concepts:</p>
<ul class="simple">
<li><p>The temporal aggreation of data through statistical summaries over different time frequncies.</p></li>
<li><p>The output of raw data as a temporary data storage.</p></li>
<li><p>Passing both raw data and data percentiles for use in the bias-correction layer.</p></li>
</ul>
<p>Parallel processing is currently implemented for most statistics through <a class="reference external" href="https://examples.dask.org/xarray.html">dask</a> to speed up computation.</p>
</section>
<section id="running-in-python">
<h2>Running in Python<a class="headerlink" href="#running-in-python" title="Permalink to this heading">¶</a></h2>
<p>As with any python library the first step is to import the package</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">one_pass.opa</span> <span class="kn">import</span> <span class="n">Opa</span>
</pre></div>
</div>
<p>After importing the library only two lines of python code are required to run</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opa_stat</span> <span class="o">=</span> <span class="n">Opa</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">yml</span><span class="p">)</span> <span class="c1"># initalise some statistic using the config.yml file</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">opa_stat</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># pass some data to compute</span>
</pre></div>
</div>
<p>Above, all the details of the requested statistic are given by the config.yml file, explained in <a class="reference internal" href="the_config_file.html"><span class="doc">The config.yml file</span></a>. The incoming <code class="docutils literal notranslate"><span class="pre">data</span></code> is an <a class="reference external" href="https://docs.xarray.dev/en/stable/">xArray</a> object containing some climate data over a given (structured or unstructured) grid and a certain temporal period. The second line will be run multiple times, as the data stream progress, continously providing new data to the Opa class. Once sufficient data has been passed to the Opa class (enough to complete the requested statistic), <code class="docutils literal notranslate"><span class="pre">dm</span></code> will return the output of the summary statistic. For detailed examples and tutorials, refer to the <a class="reference internal" href="examples_tutorials.html"><span class="doc">Examples and Tutorials</span></a> section which contain example Jupyter notebooks.</p>
</section>
<section id="a-note-on-the-output">
<h2>A note on the Output<a class="headerlink" href="#a-note-on-the-output" title="Permalink to this heading">¶</a></h2>
<p>The output, <code class="docutils literal notranslate"><span class="pre">dm</span></code> written above, will be an xr.dataSet. The dimensions will the same as the original dimensions of the input data, apart from the time dimension. The length of time dimension will be one, unless you set <code class="docutils literal notranslate"><span class="pre">output_freq</span></code> greater than <code class="docutils literal notranslate"><span class="pre">stat_freq</span></code>. See the <a class="reference internal" href="the_config_file.html"><span class="doc">The config.yml file</span></a> for details.</p>
<p>The timestamp on the time dimension will correspond to the time stamp of the first piece of data that contributed to that statistic.</p>
<p>All of the original metaData included in the dataSet will be present in the final dataSet with a new attribute corresponding to details of the one pass algorithm. There will only be one variable in the final dataSet, as the one_pass only processes one variable at a time. The name of the variable will be unchanged.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently a problem with GRIB variable names that start with a number, as when saving they are saved with a / in front. This issue is being worked on.</p>
</div>
<p>The final output from the one_pass will only be passed when sufficient data has been streamed to the Opa class to complete the statistic. If you do not set <code class="docutils literal notranslate"><span class="pre">&quot;save&quot;</span> <span class="pre">:</span> <span class="pre">True</span></code> then this will only be output in memory and will be over written as new data is passed.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">one_pass</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-concept">Basic Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-in-python">Running in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-note-on-the-output">A note on the Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="the_config_file.html">The config.yml file</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples_tutorials.html">Examples and Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to one_pass</a></li>
<li class="toctree-l1"><a class="reference internal" href="references_acknowledgements.html">References and Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="the_config_file.html" title="next chapter">The config.yml file</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Katherine Grayson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/getting_started.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>